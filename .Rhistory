source("C:/Users/emmel/AppData/Local/Packages/microsoft.windowscommunicationsapps_8wekyb3d8bbwe/LocalState/Files/S0/51/Attachments/Emmy_R[4276].R")
source("C:/Users/emmel/AppData/Local/Packages/microsoft.windowscommunicationsapps_8wekyb3d8bbwe/LocalState/Files/S0/51/Attachments/Emmy_R[4276].R")
source("C:/Users/emmel/AppData/Local/Packages/microsoft.windowscommunicationsapps_8wekyb3d8bbwe/LocalState/Files/S0/51/Attachments/Emmy_R[4276].R")
source("C:/Users/emmel/AppData/Local/Packages/microsoft.windowscommunicationsapps_8wekyb3d8bbwe/LocalState/Files/S0/51/Attachments/Emmy_R[4276].R", echo=TRUE)
# data_pivot <- pivot_longer(data, cols=c(Jun.15, Jun.22, Jul.6, Jul.13, Jul.20, Jul.27, Aug.3, Aug.10), names_to = 'Date', values_to = 'Diameter')
data_pivot$Accession_ID <- as.character(data_pivot$Accession_ID)
f <- 1
View(f)
install.packages(dplyr)
install.packages("dplyr")
??corrplot
?corrplot
?round
?read.csv
?data.frame
library(tidyverse)
?plot
library(help = "base")
plot(cars)
df <- merge(c(1,2,3), c(4,6,8))
df
plot(df)
plot(df, x~y)
plot(df, y~x)
plot(df, x, y)
?plot
plot(c(2,4,6), c(5,6,7))
plot(y~x, data = df)
plot(x~y, data = df)
?require
?boxplot
?barplot
barplot(df)
barplot(y~x, data = df)
View(height4)
height4
head(longley)
barplot(GNP ~ Year, data = ongley)
barplot(GNP ~ Year, data = longley)
?hist
head(islands)
hist(islands)
?boxplot
?pie
?plot
?barplot
?hist
?boxplot
?pie
?pch
?lty
?plot
colors()
palette()
palette.colors()
palette.pals()
library(RColorBrewer)
brewer.pal()
?RColorBrewer
brewer.pal.info
library(ggplot2)
?geom_point
?aes
library(ggplot2)
?aes
?geom_bar
library(ggplot2)
?geom_bar
library(ggplot2)
library(plantecophys)
library(tidyverse)
## Plot all ACi curves on one graph by Species
ggplot(cmplt.grp, mapping = aes(x = Ci, y = A, color = fourlettercode)) +
geom_point(mapping = aes(pch = Data_point)) +
theme_classic()
## Load Packages
library(tidyverse)
library(plantecophys)
## Plot all ACi curves on one graph by Species
ggplot(cmplt.grp, mapping = aes(x = Ci, y = A, color = fourlettercode)) +
geom_point(mapping = aes(pch = Data_point)) +
theme_classic()
source("C:/Users/emmel/Desktop/DAT_proj/Tapajos_DAT_data_assembly.R", echo=TRUE)
cmplt.rm_out <- filter(complete_sp, Ci > -50 & A < 31)
## Group by Four Letter Code
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode)
## Plot all ACi curves on one graph by Species
ggplot(cmplt.grp, mapping = aes(x = Ci, y = A, color = fourlettercode)) +
geom_point(mapping = aes(pch = Data_point)) +
theme_classic()
for (code in unique(cmplt.grp$fourlettercode)) {
df1 <- cmplt.grp %>% filter(fourlettercode == code)
gg1 <- ggplot(data = df1, mapping = aes(x = Ci, y = A, color = Data_point)) +
geom_point() +
theme_classic() +
scale_color_viridis_d()
filename1 <- paste("plot_", code, ".png")
ggsave(filename1, gg1)
}
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT")
DAT_fits <- fitacis(cmplt_DAT, group = "fourlettercode",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE,
id = Leaf_number)
### Leaf 1 Trad
abma <- filter(complete_sp, fourlettercode == "ABMA")
abma_trad <- filter(abma, Data_point == "Traditional")
abma_trad_l1 <- filter(abma_trad, Leaf_number == 1)
abma_trad_aci_l1 <- fitaci(data = abma_trad_l1,
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
fitTPU = TRUE,
Tcorrect = TRUE)
warnings()
library(tidyverse)
library(plantecophys)
#library(RCurl)
DAT_fits <- fitacis(cmplt_DAT, group = "fourlettercode",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE,
id = Leaf_number)
fitacis
data <- cmplt_DAT
d <- split(data, data[, "fourlettercode"])
fitacis(d, fourlettercode, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitacis(data, fourlettercode, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitacis(d, "fourlettercode", varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitacis(data, "fourlettercode", varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitaci(d$ABMA, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
abma_trad_aci_l1 <- fitaci(data = abma_trad_l1,
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
fitTPU = TRUE,
Tcorrect = TRUE)
warnings()
colnames(cmplt_DAT)
## Plot all ACi curves on one graph by Species
ggplot(cmplt.grp, mapping = aes(x = Ci, y = A, color = fourlettercode)) +
geom_point(mapping = aes(pch = Data_point)) +
theme_classic()
for (code in unique(cmplt.grp$fourlettercode)) {
df1 <- cmplt.grp %>% filter(fourlettercode == code)
gg1 <- ggplot(data = df1, mapping = aes(x = Ci, y = A, color = Data_point)) +
geom_point() +
theme_classic() +
scale_color_viridis_d()
filename1 <- paste("plot_", code, ".png")
ggsave(filename1, gg1)
}
getwd()
library(tidyverse)
library(greekLetters)
library(ggpubr)
wd <- "/Users/emmel/Desktop/DAT_proj/"
setwd(wd)
library(plantecophys)
cmplt.rm_out <- read.csv(file = paste0(wd, "Inputs/Aci_no_out.csv"), header = TRUE, sep = ",")
cmplt_DAT <- filter(cmplt.rm_out, Data_point == "Before_DAT")
cmplt_trad <- filter(cmplt.rm_out, Data_point == "Traditional")
DAT_filt <- cmplt_DAT
DAT_filt_ex <- DAT_filt %>%
group_by(unique) %>%
group_modify(~exclude_backwardsCi(data = .x, givedf = TRUE), .keep = FALSE)
min_Ci_ind <- which(data$Ci == min(data$Ci))
## Make function to find min Ci and exclude points with Anet below the Anet for that min Ci
exclude_backwardsCi <- function(data, givedf){
min_Ci_ind <- which(data$Ci == min(data$Ci))
data_new <- slice(data, -which(data$A < data$A[min_Ci_ind]))
if(givedf =="TRUE"){
data_new <- as.data.frame(data_new)
}
return(data_new)
}
DAT_filt_ex <- DAT_filt %>%
group_by(unique) %>%
group_modify(~exclude_backwardsCi(data = .x, givedf = TRUE), .keep = FALSE)
DAT_filt_ex <- as.data.frame(DAT_filt_ex)
unique(DAT_filt_ex$unique)
k6702l1 <- filter(DAT_filt_ex, unique == "K6702L1")
k6702l1_fit <- fitaci(k6702l1, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
plot(k6702l1_fit)
coef(k6702l1_fit)
View(k6702l1_fit)
install.packages(Metrics)
install.packages("Metrics")
library(Metrics)
## Load in the datasets
params_ecophys <- read.csv(file = paste0(wd, "Results/params_ecophys.csv"), sep = ",",
header = TRUE) %>%
filter(method == "dat")
params_ecophys <- add_row(.data = params_ecophys, unique = "K6702L1", Vcmax = 15.361861,
Jmax = 27.750436, Rd = -1.010354,
TPU = 1.78906, Vcmax_SE = NA, Jmax_SE = NA, Rd_SE = NA, TPU_SE = NA,
unique.1 = "K6702L1", method = "dat") %>%
arrange(unique)
params_photo <- read.csv(file = paste0(wd, "Results/dat_fit_ex_photo_pars.csv"), sep = ",",
header = TRUE)
params_mg <- read.csv(file = paste0(wd, "Results/curve_fitting_MG_out.csv"), sep = ",",
header = TRUE) %>%
filter(DAT == "Before_DAT", back_filt == "back_filtered")
# Vcmax
rmse(params_ecophys$Vcmax, params_photo$V_cmax)
ecovphoto_vcmax <- ggplot(mapping = aes(x = params_ecophys$Vcmax, y = params_photo$V_cmax,
color = params_photo$ID)) +
geom_point()+
geom_abline(intercept = 0, slope = 1)+
theme_classic()+
labs(x="Plantecophys Vcmax", y="Photosynthesis Vcmax", col = "Leaf")+
theme(axis.title.x=element_text(size=18, family = "serif"),
axis.title.y=element_text(size=18, family = "serif"),
axis.text.x=element_text(size=15, family = "serif"),
axis.text.y=element_text(size=15, family = "serif"),
legend.text=element_text(size=7, family = "serif"),
legend.title=element_text(size=11, family = "serif")) +
scale_x_continuous(limits = c(1, 150)) +
scale_y_continuous(limits = c(1, 150)) +
annotate(geom = "text", label = "RMSE = 33.03")
ecovphoto_vcmax
ecovphoto_vcmax <- ggplot(mapping = aes(x = params_ecophys$Vcmax, y = params_photo$V_cmax,
color = params_photo$ID)) +
geom_point()+
geom_abline(intercept = 0, slope = 1)+
theme_classic()+
labs(x="Plantecophys Vcmax", y="Photosynthesis Vcmax", col = "Leaf")+
theme(axis.title.x=element_text(size=18, family = "serif"),
axis.title.y=element_text(size=18, family = "serif"),
axis.text.x=element_text(size=15, family = "serif"),
axis.text.y=element_text(size=15, family = "serif"),
legend.text=element_text(size=7, family = "serif"),
legend.title=element_text(size=11, family = "serif")) +
scale_x_continuous(limits = c(1, 150)) +
scale_y_continuous(limits = c(1, 150)) +
annotate(geom = "text", label = "RMSE = 33.03", x = 100, y = 50)
ecovphoto_vcmax
ecovphoto_vcmax <- ggplot(mapping = aes(x = params_ecophys$Vcmax, y = params_photo$V_cmax,
color = params_photo$ID)) +
geom_point()+
geom_abline(intercept = 0, slope = 1)+
theme_classic()+
labs(x="Plantecophys Vcmax", y="Photosynthesis Vcmax", col = "Leaf")+
theme(axis.title.x=element_text(size=18, family = "serif"),
axis.title.y=element_text(size=18, family = "serif"),
axis.text.x=element_text(size=15, family = "serif"),
axis.text.y=element_text(size=15, family = "serif"),
legend.text=element_text(size=7, family = "serif"),
legend.title=element_text(size=11, family = "serif")) +
scale_x_continuous(limits = c(1, 150)) +
scale_y_continuous(limits = c(1, 150)) +
annotate(geom = "text", label = "RMSE = 33.03", x = 125, y = 50)
ecovphoto_vcmax
View(params_mg)
rmse(params_ecophys$Vcmax, params_mg$Best_Vcmax_25C)
ecovMG_vcmax <- ggplot(mapping = aes(x = params_ecophys$Vcmax, y = params_mg$Best_Vcmax_25C,
color = params_mg$Tree_id))+
geom_point()+
geom_abline(intercept = 0, slope = 1)+
theme_classic()+
labs(x="Plantecophys Vcmax", y="MG Vcmax", col = "Leaf")+
theme(axis.title.x=element_text(size=18, family = "serif"),
axis.title.y=element_text(size=18, family = "serif"),
axis.text.x=element_text(size=15, family = "serif"),
axis.text.y=element_text(size=15, family = "serif"),
legend.text=element_text(size=7, family = "serif"),
legend.title=element_text(size=11, family = "serif")) +
scale_x_continuous(limits = c(1, 170)) +
scale_y_continuous(limits = c(1, 170)) +
annotate(geom = "text", label = "RMSE = 16.63", x = 125, y = 50)
ecovMG_vcmax
rmse(params_photo$V_cmax, params_mg$vcmax_Best_Model)
photovMG_vcmax <- ggplot(mapping = aes(x = params_photo$V_cmax, y = params_mg$vcmax_Best_Model,
color = params_photo$ID))+
geom_point()+
geom_abline(intercept = 0, slope = 1)+
theme_classic()+
labs(x = "Photosynthesis Vcmax", y = "MG Vcmax", col = "Leaf")+
theme(axis.title.x=element_text(size=18, family = "serif"),
axis.title.y=element_text(size=18, family = "serif"),
axis.text.x=element_text(size=15, family = "serif"),
axis.text.y=element_text(size=15, family = "serif"),
legend.text=element_text(size=7, family = "serif"),
legend.title=element_text(size=11, family = "serif")) +
scale_x_continuous(limits = c(1, 170)) +
scale_y_continuous(limits = c(1, 170)) +
annotate(geom = "text", label = "RMSE = 22.06", x = 125, y = 50)
photovMG_vcmax
#Jmax
rmse(params_ecophys$Jmax, params_mg$Best.Jmax_25C)
View(params_mg)
View(params_ecophys)
params_ecophys[3,7]
params_ecophys[7,3]
params_ecophys[7,3] <- NA
#Jmax
rmse(params_ecophys$Jmax, params_mg$Best.Jmax_25C)
#Jmax
rmse(params_ecophys$Jmax, params_mg$Best.Jmax_25C)
rmse(params_ecophys$Jmax, params_photo$J_max)
rmse(params_photo$J_max, params_mg$Jmax_Best)
photovMG_jmax <- ggplot(mapping = aes(x = params_photo$J_max, y = params_mg$Jmax_Best,
color = params_photo$ID))+
geom_point()+
geom_abline(intercept = 0, slope = 1)+
theme_classic()+
labs(x="Photosynthesis Jmax", y="MG Jmax", col = "Leaf")+
theme(axis.title.x=element_text(size=18, family = "serif"),
axis.title.y=element_text(size=18, family = "serif"),
axis.text.x=element_text(size=15, family = "serif"),
axis.text.y=element_text(size=15, family = "serif"),
legend.text=element_text(size=7, family = "serif"),
legend.title=element_text(size=11, family = "serif")) +
scale_x_continuous(limits = c(1, 200)) +
scale_y_continuous(limits = c(1, 200)) +
annotate(geom = "text", label = "RMSE = 37.64", x = 125, y = 50)
photovMG_jmax
#TPU
rmse(params_ecophys$TPU, params_mg$TPU_Best)
rmse(params_ecophys$TPU, params_photo$V_TPU)
rmse(params_photo$V_TPU, params_mg$TPU_Best)
?rmse
hydroGOF::rmse(params_ecophys$Jmax, params_mg$Best.Jmax_25C)
