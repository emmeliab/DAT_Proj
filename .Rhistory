d <- split(data, data[, "fourlettercode"])
fitacis(d, fourlettercode, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitacis(data, fourlettercode, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitacis(d, "fourlettercode", varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitacis(data, "fourlettercode", varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
fitaci(d$ABMA, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"), fitTPU = TRUE, Tcorrect = TRUE)
abma_trad_aci_l1 <- fitaci(data = abma_trad_l1,
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci", PPFD = "Qin"),
fitTPU = TRUE,
Tcorrect = TRUE)
warnings()
colnames(cmplt_DAT)
## Plot all ACi curves on one graph by Species
ggplot(cmplt.grp, mapping = aes(x = Ci, y = A, color = fourlettercode)) +
geom_point(mapping = aes(pch = Data_point)) +
theme_classic()
for (code in unique(cmplt.grp$fourlettercode)) {
df1 <- cmplt.grp %>% filter(fourlettercode == code)
gg1 <- ggplot(data = df1, mapping = aes(x = Ci, y = A, color = Data_point)) +
geom_point() +
theme_classic() +
scale_color_viridis_d()
filename1 <- paste("plot_", code, ".png")
ggsave(filename1, gg1)
}
# Load Packages/Data ------------------------------------------------------
## Load Packages
library(tidyverse)
library(plantecophys)
library(greekLetters)
library(ggpubr)
getwd()
setwd("C://Users/emmel/Desktop/DAT_proj")
getwd()
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv")
head(unique_ids)
# Load Data
complete_sp <- read.csv("/Inputs/clean_aci_with_uniquecode.csv",
sep = ",",
fileEncoding="latin1")
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv",
sep = ",",
fileEncoding="latin1")
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < 0) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40) # 2 A values greater than 31: 399 and 400
which(complete_sp$A < 1)
complete_sp[c(397,398,399,400,401),17]
cmplt.rm_out <- filter(complete_sp, Ci > 0 & A < 31)  ## Ci > 0 (we had been doing Ci > -50)
#filter again for A above 1 to try and fix the DAT curves that look weird
which(complete_sp$A < 1)
cmplt.rm_out <- filter(complete_sp, A > 1)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
# Fitting ACi Curves ------------------------------------------------------
# install.packages("greekLetters")
library(greekLetters)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[7]]) # I was just exploring here
coef(DAT_fits)
plot(DAT_fits[[1]]) # I was just exploring here
plot(DAT_fits[[2]]) # I was just exploring here
plot(DAT_fits[[3]]) # I was just exploring here
plot(DAT_fits[[4]]) # I was just exploring here
plot(DAT_fits[[5]]) # I was just exploring here
plot(DAT_fits[[6]]) # I was just exploring here
plot(DAT_fits[[7]]) # I was just exploring here
plot(DAT_fits[[8]]) # I was just exploring here
plot(DAT_fits[[9]]) # I was just exploring here
plot(DAT_fits[[10]]) # I was just exploring here
## Make a dataframe out of coefficients
par_dat <- as.data.frame(coef(DAT_fits), row.names = NULL)
par_dat <- par_dat[-1,]
par_dat <- par_dat %>%
add_column(method = "dat")
table(par_dat$method) ## number of initial DAT curves
# Fit the ACi curves for Traditional using fitacis
trad_fits <- fitacis(cmplt_trad, group = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(trad_fits[[20]]) # 20 is pretty ugly
coef(trad_fits)
plot(trad_fits[[15]]) # 20 is pretty ugly
coef(trad_fits)
## Make a dataframe of coefficients
par_trad <- as.data.frame(coef(trad_fits), row.names = NULL)
par_trad <- par_trad[-1,]
par_trad <- par_trad %>%
add_column(method = "trad")
# Merge DAT and Trad dfs
par_join <- bind_rows(par_dat, par_trad)
par_species <- left_join(par_join, unique_ids, by = "unique")
par_join
par_species <- left_join(par_join, unique_ids, by = "unique")
par_species
par_species <- left_join(par_join, unique_ids, by = "unique") # why isn't this working?
colnames(par_join)
rlang::last_error()
# Load Packages/Data ------------------------------------------------------
## Load Packages
library(tidyverse)
library(plantecophys)
library(greekLetters)
library(ggpubr)
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < 0) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40) # 2 A values greater than 31: 399 and 400
which(complete_sp$A < 1)
complete_sp[c(397,398,399,400,401),17]
cmplt.rm_out <- filter(complete_sp, Ci > 0 & A < 31)  ## Ci > 0 (we had been doing Ci > -50)
#filter again for A above 1 to try and fix the DAT curves that look weird
which(complete_sp$A < 1)
cmplt.rm_out <- filter(complete_sp, A > 1)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
View(cmplt_DAT)
View(complete_sp)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[16])
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[16])
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
# Load Packages/Data ------------------------------------------------------
## Load Packages
library(tidyverse)
library(plantecophys)
library(greekLetters)
library(ggpubr)
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < 0) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40) # 2 A values greater than 31: 399 and 400
which(complete_sp$A < 1)
complete_sp[c(397,398,399,400,401),17]
cmplt.rm_out <- filter(complete_sp, Ci > 0 & A < 31)  ## Ci > 0 (we had been doing Ci > -50)
#filter again for A above 1 to try and fix the DAT curves that look weird
which(complete_sp$A < 1)
cmplt.rm_out <- filter(complete_sp, A > 1)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
plot(DAT_fits[[14]], main = coef(DAT_fits)$unique[14])
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[16])
k6709l2.2_filt <- filter(complt_dat, unique = "K6709L2-2")
k6709l2.2_filt <- filter(cmplt_dat, unique = "K6709L2-2")
k6709l2.2_filt <- filter(cmplt_DAT, unique = "K6709L2-2")
k6709l2.2_filt <- filter(cmplt_DAT, unique == "K6709L2-2")
k6709l2.2_filt
View(cmplt.grp)
View(cmplt.rm_out)
cmplt.rm_out <- filter(complete_sp, Ci > 0 | A < 31)  ## Ci > 0 (we had been doing Ci > -50)
View(cmplt.rm_out)
#filter again for A above 1 to try and fix the DAT curves that look weird
which(complete_sp$A < 1)
cmplt.rm_out <- filter(complete_sp, A > 1)
cmplt.rm_out <- filter(complete_sp, Ci > 0 | A < 31)  ## Ci > 0 (we had been doing Ci > -50)
View(cmplt.rm_out)
View(complete_sp)
cmplt.rm_out <- filter(complete_sp, Ci > 0 | A < 31)  ## Ci > 0 (we had been doing Ci > -50)
#filter again for A above 1 to try and fix the DAT curves that look weird
which(complete_sp$A < 1)
cmplt.rm_out <- filter(cmplt.rm_out, A > 1)
View(cmplt.rm_out)
View(complete_sp)
cmplt.rm_out1 <- filter(complete_sp, Ci > 0)  ## Ci > 0 (we had been doing Ci > -50)
View(cmplt.rm_out1)
cmplt.rm_out2 <- filter(cmplt.rm_out2, A < 31)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 31)
View(cmplt.rm_out1)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40)
View(cmplt.rm_out2)
#filter again for A above 1 to try and fix the DAT curves that look weird
which(complete_sp$A < 1)
cmplt.rm_out <- filter(cmplt.rm_out2, A > -1)
View(cmplt.rm_out)
cmplt.rm_out <- filter(cmplt.rm_out2, A > 0)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[16])
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[16])
plot(DAT_fits[[1]], main = coef(DAT_fits)$unique[1])
plot(DAT_fits[[1]], main = coef(DAT_fits)$unique[1])
coef(DAT_fits)
plot(DAT_fits[[1]], main = coef(DAT_fits)[[unique[1]]])
plot(DAT_fits[[1]])
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
plot(DAT_fits[[15]])
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
coef(DAT_fits)
coef(DAT_fits)
#strange curves: #7, 9, 10, 11, 12, 15, 17, 22, 23, 24?
## Make a dataframe out of coefficients
par_dat <- as.data.frame(coef(DAT_fits), row.names = NULL)
View(DAT_fits)
cmplt_all <- select(cmplt.grp, -contains(greeks("Delta")))
# Attempt to run fitacis with all, separated by a factor
all_fits <- fitacis(cmplt_all, group = "unique", id = "Data_point",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(all_fits, how = "oneplot")
# Load Packages/Data ------------------------------------------------------
## Load Packages
library(tidyverse)
library(plantecophys)
library(greekLetters)
library(ggpubr)
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < 0) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40) # 2 A values greater than 31: 399 and 400
which(complete_sp$A < 1)
complete_sp[c(397,398,399,400,401),17]
which(complete_sp$A < 0)
cmplt.rm_out1 <- filter(complete_sp, Ci > 0)  ## Ci > 0 (we had been doing Ci > -50)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40) ## A < 40
cmplt.rm_out <- filter(cmplt.rm_out2, A > 0)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
cmplt_all <- select(cmplt.grp, -contains(greeks("Delta")))
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
plot(DAT_fits[[15]])
coef(DAT_fits)
# Load Packages/Data ------------------------------------------------------
## Load Packages
library(tidyverse)
library(plantecophys)
library(greekLetters)
library(ggpubr)
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < 0) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40) # 2 A values greater than 31: 399 and 400
which(complete_sp$A < 1)
complete_sp[c(397,398,399,400,401),17]
which(complete_sp$A < 0)
cmplt.rm_out1 <- filter(complete_sp, Ci > 0)  ## Ci > 0 (we had been doing Ci > -50)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40) ## A < 40
cmplt.rm_out <- filter(cmplt.rm_out2, A > 0)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
cmplt_all <- select(cmplt.grp, -contains(greeks("Delta")))
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[15])
plot(DAT_fits[[15]])
coef(DAT_fits)
coef$DAT_fits
plot(DAT_fits[[15]], main = coef(DAT_fits)$unique[[15]])
# Load Packages/Data ------------------------------------------------------
## Load Packages
library(tidyverse)
library(plantecophys)
library(greekLetters)
library(ggpubr)
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$obs == 802)
complete_sp[c(399)]
complete_sp[c(399),]
complete_sp[c(400),]
cmplt.rm_out1 <- filter(complete_sp, Ci > -5)  ## Ci > 0 (we had been doing Ci > -50)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40) ## A < 40
cmplt.rm_out3 <- filter(cmplt.rm_out2, !A %in% c(399, 400))
cmplt.rm_out3 <- filter(cmplt.rm_out2, !A %in% c(36.68805, 35.94128))
cmplt.rm_out3 <- filter(cmplt.rm_out2, A != 35.94128)
which(complete_sp$elapsed == 14251)
cmplt.rm_out3 <- filter(cmplt.rm_out2, -c(400))
cmplt.rm_out3 <- filter(cmplt.rm_out2, -[c(400)])
View(cmplt.rm_out2)
cmplt.rm_out3 <- -complete_sp[c(400),])
-complete_sp[c(400),]
complete_sp[-c(400),]
cmplt.rm_out3 <- slice(cmplt.rm_out2, -(400))
cmplt.rm_out3[c(400),]
cmplt.rm_out3[c(399),]
complete_sp <- slice(complete_sp, -(400))
complete_sp <- slice(complete_sp, -(399,400))
complete_sp <- slice(complete_sp, -(399:400))
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$elapsed == 14251)
complete_sp[c(399),]  ## I visually identified these outliers
complete_sp[c(400),]  ## this one too
complete_sp[c(400),]
complete_sp <- slice(complete_sp, -(399:400))
which(complete_sp$A > 40)
which(complete_sp$A < 1)
which(complete_sp$A < -1)
which(complete_sp$A < 0)
which(complete_sp$Ci < -5) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40)
which(complete_sp$A < -1)
cmplt.rm_out1 <- filter(complete_sp, Ci > -5)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40) ## A < 40
cmplt.rm_out <- filter(cmplt.rm_out2, A > -1)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[[16]])
coef(DAT_fits)
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
which(complete_sp$elapsed == 14251)
complete_sp[c(397:403),]  ## I visually identified these outliers
complete_sp <- slice(complete_sp, -(398:402))
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < -5) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40)
which(complete_sp$A < -1)
cmplt.rm_out1 <- filter(complete_sp, Ci > -5)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40) ## A < 40
cmplt.rm_out <- filter(cmplt.rm_out2, A > -1)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[[16]])
# Load Data
complete_sp <- read.csv("Inputs/clean_aci_with_uniquecode.csv", sep = ",",
fileEncoding="latin1") #changed this to work on anyone's computer
#Create an id data table. This includes the species code so we can merge it later
unique_ids <- read.csv("Inputs/unique_ids.csv") # same here
complete_sp[c(397:402),]  ## I visually identified these outliers
complete_sp <- slice(complete_sp, -(397:402))
which(complete_sp$Ci < -50) #4 Ci values are super negative: 394, 395, 396, 398
which(complete_sp$Ci < -5) # Add in 16 more values, all for MACA1
complete_sp[c(394,395,396,398),19] # What are those values? Should they be outliers?
which(complete_sp$A > 40)
which(complete_sp$A < -1)
cmplt.rm_out1 <- filter(complete_sp, Ci > -5)
cmplt.rm_out2 <- filter(cmplt.rm_out1, A < 40) ## A < 40
cmplt.rm_out <- filter(cmplt.rm_out2, A > -1)
## Group by unique
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(unique)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Fit the ACi curves for each species for DAT using fitacis
DAT_fits <- fitacis(cmplt_DAT, group = "unique", id = "unique",
varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"), fitTPU = FALSE, Tcorrect = TRUE)
plot(DAT_fits[[16]], main = coef(DAT_fits)$unique[[16]])
coef(DAT_fits)
# I made a for loop that saves all the plots
for (curve in 1:33){
title <- coef(DAT_fits)$unique[[curve]]
png(filename = paste0(getwd(), "/Outputs/", title,"_dataci_curve.png"))
plot(DAT_fits[[curve]], main = title)
dev.off()
}
