for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
id <- paste0(cmplt_trad$k67.id[code], "_", trad$Leaf_number)
trad_pars <- bind_rows(trad_pars, par.df2, .id = "id")
}
trad_pars
remove(trad_pars)
id <- as.data.frame(paste0(cmplt_trad$k67.id[code], "_", trad$Leaf_number))
id
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
id <- as.data.frame(paste0(cmplt_trad$k67.id[code], "_lf", trad$Leaf_number))
trad_pars <- bind_rows(trad_pars, par.df2, .id = "id")
}
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
id <- as.data.frame(paste0(cmplt_trad$k67.id[code], "_lf", trad$Leaf_number))
trad_pars <- bind_rows(trad_pars, par.df2, .id = "id")
}
trad_pars
id
View(id)
# Traditional
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, id = (paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number)))
trad_pars <- bind_rows(trad_pars, par.df2, .id = "id")
}
# Traditional
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, id = paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number))
trad_pars <- bind_rows(trad_pars, par.df2, .id = "id")
}
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, id = paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number))
trad_pars <- bind_rows(trad_pars, par.df3, .id = "id")
}
# Traditional
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
?mutate
par.df3 <- mutate(par.df2, id = paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number)
)
paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number)
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"), .before = TRUE)
par.df3 <- mutate(par.df2, id = paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf]))
trad_pars <- bind_rows(trad_pars, par.df3, .id = "id")
}
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"), .before = TRUE)
par.df3 <- mutate(par.df2, id = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3, .id = "id")
}
paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])
rlang::last_error()
# Traditional
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"), .before = TRUE)
par.df3 <- mutate(par.df2, id = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3, .id = "id")
}
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, id = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3, .id = "id")
}
trad_pars
par.df3
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, name = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3, .id = "name")
}
trad_pars
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
#par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
#  trad$Leaf_number[lf])))
trad_pars <- bind_rows(lst(trad_pars, par.df2), .id = "id")
}
trad_pars
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
#par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
#  trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df2, .id = c(a,b))
}
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
#par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
#  trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df2, .id = trad_fit_list)
}
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
#par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
#  trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df2, .id = df)
}
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3, .id = par.df3$Curve)
}
### adding a column for a four-letter species code and a column for species name
complete_sp <- all_aci_cln_num %>%
mutate(fourlettercode = Tree_Identifier, SciName = Tree_Identifier,
k67.id = Tree_Identifier)
complete_sp$fourlettercode <- recode(complete_sp$fourlettercode,
'Maca1' = 'MAEL',
'Tree3' = 'CHTU',
'tree8' = 'COSP',
'Tree8' = 'COSP',
'tree9' = 'APCO',
'Tree10' = 'VICA',
'tree11' = 'COST',
'tree12' = 'UNKN',
'tree22' = 'ABMA',
'1' = 'TACH',
'4' = 'ESSP',
'Tree5' = 'ABMA',
'Tree6' = 'PRAP',
'Mela7' = 'MELA',
'maca1' = 'MAEL')
complete_sp$SciName <- recode(complete_sp$SciName,
'Maca1' = 'Manilkara elata',
'Tree3' = 'Chimaris turbinata',
'tree8' = 'Coussarea sp',
'Tree8' = 'Coussarea sp',
'tree9' = 'Aparisthmium cordatum',
'Tree10' = 'Vismia cayennensis',
'tree11' = 'Couratari stellata',
'tree12' = 'Unknown sp',
'tree22' = 'Abarema mataybifolia',
'1' = 'Tachigali chrysophylla',
'4' = 'Eschweilera sp.',
'Tree5' = 'Abarema mataybifolia',
'Tree6' = 'Protium apiculatum',
'Mela7' = 'Unknown sp.',
'maca1' = 'Manilkara elata')
complete_sp$k67.id <- recode(complete_sp$k67.id,
'Maca1' = 'K67-WT-09',
'maca1' = 'K67-WT-09',
'1' = 'K67-WT-07',
'Tree3' = 'K67-WT-08',
'4' = 'K67-WT-06',
'Tree5' = 'K67-WT-04',
'Tree6' = 'K67-WT-05',
'Mela7' = 'K67-WT-16',
'tree8' = 'K67-WT-15',
'Tree8' = 'K67-WT-15',
'tree9' = 'K67-WT-17',
'Tree10' = 'K67-WT-13',
'tree11' = 'K67-WT-02',
'tree12' = 'K67-WT-14',
'tree22' = 'K67-WT-18')
unique(complete_sp$fourlettercode)
unique(complete_sp$k67.id)
# Save Complete Data File -------------------------------------------------
## Save the assembled file as a .csv
write.csv(x = complete_sp, file = "clean_aci_data_one_file.csv",
row.names = FALSE)
#setwd()
complete_sp <- read.csv("Inputs/clean_aci_data_one_file.csv",
sep = ",",
fileEncoding="latin1")
cmplt.rm_out <- filter(complete_sp, Ci > -50 & A < 31)
## Group by Four Letter Code
cmplt.grp <- group_by(cmplt.rm_out, fourlettercode) %>%
group_by(Leaf_number)
## Separate by DAT and trad, and convert to dataframe
cmplt_DAT <- filter(cmplt.grp, Data_point == "Before_DAT") %>%
select(-contains(greeks("Delta"))) #removes the columns with deltas
cmplt_DAT <- as.data.frame(cmplt_DAT)
head(cmplt_DAT)
cmplt_trad <- filter(cmplt.grp, Data_point == "Traditional") %>%
select(-contains(greeks("Delta")))
cmplt_trad <- as.data.frame(cmplt_trad)
head(cmplt_trad)
# Traditional
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3, .id = par.df3$Curve)
}
# Traditional
remove(trad_pars) #remove the data frame if you've ran it before
trad_pars <- data.frame()
for (code in 1:length(unique(cmplt_trad$k67.id))) {
ind <- cmplt_trad$k67.id == cmplt_trad$k67.id[code]
trad <- cmplt_trad[ind, ]
#print(head(trad))
for (lf in 1:length(unique(trad$Leaf_number))) {
indlf <- trad$Leaf_number == trad$Leaf_number[lf]
tradlf <- trad[indlf, ]
fit <- fitaci(data = tradlf, varnames = list(ALEAF = "A", Tleaf = "Tleaf", Ci = "Ci",
PPFD = "Qin"),
fitTPU = FALSE, Tcorrect = TRUE)
plot(fit, main = paste(cmplt_trad$k67.id[code], "Leaf", trad$Leaf_number[lf]))
assign(paste0("trad_fit_", cmplt_trad$k67.id[code], "_lf", trad$Leaf_number[lf]), fit)
summary(fit)
}
# This next part makes the summary tables and appends them together
par <- fit$pars
par.df <- as.data.frame(par, row.names = NULL)
par.df2 <- mutate(par.df, Result = c("Vcmax", "Jmax", "Rd"))
par.df3 <- mutate(par.df2, Curve = as.character(paste0(cmplt_trad$k67.id[code], "_lf",
trad$Leaf_number[lf])))
trad_pars <- bind_rows(trad_pars, par.df3)#, .id = par.df3$Curve)
}
trad_pars
sapply(trad_fit_list, summary)
class(trad_pars)
